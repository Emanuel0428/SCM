---
import Layout from '../layouts/Layout.astro';
import InventarioCRUD from '../components/InventarioCRUD.astro';
import MovimientoCRUD from '../components/MovimientoCRUD.astro';
---
<Layout>
  <div class="flex flex-col items-center w-full">
    <h1 class="text-3xl font-extrabold mb-6 text-blue-900 text-center drop-shadow">Gestión de Inventario</h1>
    
    <div class="w-full mb-6">
      <div class="sm:hidden">
        <label for="tabs" class="sr-only">Seleccionar vista</label>
        <select id="tabs" name="tabs" class="block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500">
          <option>Activos</option>
          <option>Movimientos</option>
        </select>
      </div>
      <div class="hidden sm:block">
        <div class="border-b border-gray-200">
          <nav class="-mb-px flex space-x-8" aria-label="Tabs">
            <button
              class="border-blue-500 text-blue-600 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"
              aria-current="page"
              id="tab-activos"
            >
              Activos
            </button>
            <button
              class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"
              id="tab-movimientos"
            >
              Movimientos
            </button>
          </nav>
        </div>
      </div>
    </div>

    <div class="w-full gap-8 mb-10">
      <div id="panel-activos">
        <InventarioCRUD />
      </div>
      <div id="panel-movimientos" class="hidden">
        <MovimientoCRUD />
      </div>
    </div>
  </div>
</Layout>

<script>
  // Manejo de pestañas
  const tabActivos = document.getElementById('tab-activos');
  const tabMovimientos = document.getElementById('tab-movimientos');
  const panelActivos = document.getElementById('panel-activos');
  const panelMovimientos = document.getElementById('panel-movimientos');
  const tabSelect = document.querySelector('select#tabs');

  function showTab(tab: 'activos' | 'movimientos') {
    if (tab === 'activos') {
      tabActivos?.classList.add('border-blue-500', 'text-blue-600');
      tabActivos?.classList.remove('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
      tabMovimientos?.classList.remove('border-blue-500', 'text-blue-600');
      tabMovimientos?.classList.add('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
      panelActivos?.classList.remove('hidden');
      panelMovimientos?.classList.add('hidden');
    } else {
      tabMovimientos?.classList.add('border-blue-500', 'text-blue-600');
      tabMovimientos?.classList.remove('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
      tabActivos?.classList.remove('border-blue-500', 'text-blue-600');
      tabActivos?.classList.add('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
      panelMovimientos?.classList.remove('hidden');
      panelActivos?.classList.add('hidden');
    }
  }

  tabActivos?.addEventListener('click', () => {
    showTab('activos');
    const select = document.querySelector<HTMLSelectElement>('select#tabs');
    if (select) select.value = 'Activos';
  });

  tabMovimientos?.addEventListener('click', () => {
    showTab('movimientos');
    const select = document.querySelector<HTMLSelectElement>('select#tabs');
    if (select) select.value = 'Movimientos';
  });

  // Manejar el select en móvil
  tabSelect?.addEventListener('change', (event) => {
    const target = event.target as HTMLSelectElement;
    showTab(target.value === 'Activos' ? 'activos' : 'movimientos');
  });
</script>
